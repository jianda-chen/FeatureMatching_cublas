#include <cstring>
#include <cstdio>
#include <vector>

#include "cuda_match.h"


int main()
{
	float A[2*128] = {0.0034,0.0282,0.0397,0.0287,0.0017,0.0316,0.2545,0.0479,0.0075,0.0332,0.0428,0.0064,0.0050,0.0270,0.1065,0.0512,0.0094,0.0193,0.0160,0.0136,0.0091,0.0094,0.0359,0.0142,0.0078,0.0035,0.0056,0.0282,0.0084,0.0032,0.0060,0.0133,0.0355,0.0049,0.0034,0.0023,0.0020,0.0429,0.2969,0.2863,0.2692,0.0149,0.0017,0.0001,0.0003,0.0128,0.2063,0.2969,0.0709,0.0350,0.0157,0.0104,0.0085,0.0072,0.0396,0.0857,0.0103,0.0062,0.0147,0.0148,0.0043,0.0057,0.0365,0.0174,0.0611,0.1042,0.0090,0.0015,0.0039,0.0136,0.0174,0.0392,0.2969,0.2969,0.0178,0.0005,0.0004,0.0014,0.0119,0.2098,0.1456,0.0917,0.0505,0.0115,0.0112,0.0063,0.0272,0.0544,0.0092,0.0118,0.0267,0.0290,0.0098,0.0042,0.0175,0.0128,0.0510,0.2969,0.1567,0.0002,0.0001,0.0008,0.0008,0.0016,0.1315,0.2969,0.1044,0.0062,0.0004,0.0006,0.0048,0.0112,0.0399,0.0348,0.0191,0.0099,0.0075,0.0060,0.0174,0.0100,0.0007,0.0039,0.0095,0.0145,0.0083,0.0021,0.0135,0.0202,
				  0.0934,0.0065,0.0041,0.0033,0.0017,0.0005,0.0390,0.3107,0.2531,0.0047,0.0054,0.0115,0.0051,0.0042,0.0543,0.3107,0.0223,0.0096,0.0269,0.0242,0.0022,0.0038,0.0884,0.0640,0.0014,0.0026,0.0165,0.0339,0.0028,0.0028,0.0511,0.0362,0.0858,0.0832,0.0913,0.0038,0.0003,0.0002,0.0027,0.0581,0.3107,0.2102,0.0620,0.0019,0.0001,0.0001,0.0021,0.2697,0.1775,0.0385,0.0397,0.0497,0.0099,0.0069,0.0174,0.0433,0.0024,0.0089,0.0435,0.0157,0.0022,0.0056,0.0186,0.0184,0.0127,0.2395,0.3107,0.0791,0.0019,0.0003,0.0010,0.0027,0.1752,0.3107,0.2990,0.0275,0.0041,0.0012,0.0145,0.0139,0.0675,0.0521,0.0287,0.0182,0.0046,0.0092,0.0338,0.0327,0.0024,0.0089,0.0239,0.0098,0.0098,0.0061,0.0101,0.0140,0.0012,0.0064,0.0714,0.0658,0.0084,0.0046,0.0178,0.0148,0.0075,0.0174,0.0754,0.0527,0.0072,0.0047,0.0232,0.0264,0.0064,0.0088,0.0675,0.0484,0.0009,0.0005,0.0260,0.0383,0.0015,0.0033,0.0444,0.0407,0.0073,0.0036,0.0211,0.0293,
				  };
	float B[3*128] = {0.0005,0.0026,0.0049,0.0032,0.0058,0.0570,0.2684,0.0068,0.0029,0.0028,0.0030,0.0017,0.0121,0.0502,0.2647,0.0900,0.0312,0.0169,0.0012,0.0006,0.0021,0.0136,0.0571,0.0434,0.0280,0.0290,0.0006,0.0001,0.0001,0.0050,0.0094,0.0148,0.0033,0.0025,0.0015,0.0022,0.0048,0.0589,0.2684,0.0279,0.0866,0.0024,0.0017,0.0007,0.0005,0.0149,0.2684,0.2684,0.2634,0.0290,     0,     0,     0,0.0004,0.0898,0.2684,0.0612,0.0310,0.0004,0.0000,0.0076,0.0085,0.0109,0.0265,0.0031,0.0026,0.0037,0.0041,0.0074,0.0191,0.0079,0.0044,0.1666,0.0705,0.0056,0.0021,0.0027,0.0147,0.0182,0.0900,0.2684,0.2684,0.0022,0.0003,     0,0.0007,0.0126,0.1837,0.0610,0.0532,0.0135,0.0027,0.0096,0.0138,0.0129,0.0274,0.0045,0.0313,0.0077,0.0008,0.0041,0.0136,0.0034,0.0012,0.1440,0.2684,0.0237,0.0004,0.0031,0.0021,0.0004,0.0001,0.2341,0.2684,0.0171,0.0042,0.0014,0.0027,0.0019,0.0009,0.0088,0.0154,0.0045,0.0103,0.0179,0.0236,0.0063,0.0007,
				  0.0029,0.0096,0.0080,0.0072,0.0215,0.0259,0.1434,0.0250,0.0305,0.0217,0.0013,0.0003,0.0008,0.0135,0.0627,0.0346,0.0275,0.0439,0.0048,     0,0.0007,0.0199,0.0260,0.0254,0.0035,0.0435,0.0197,0.0016,0.0030,0.0569,0.0176,0.0008,0.0104,0.0015,0.0013,0.0007,0.0013,0.0293,0.2909,0.2909,0.1735,0.0084,     0,     0,0.0000,0.0035,0.2586,0.2909,0.1131,0.0371,0.0027,0.0005,0.0053,0.0063,0.0397,0.0956,0.0028,0.0065,0.0023,0.0077,0.0392,0.0465,0.0164,0.0028,0.0494,0.0411,0.0099,0.0026,0.0051,0.0161,0.0380,0.0733,0.2909,0.2909,0.0083,0.0000,0.0000,0.0004,0.0405,0.2909,0.1920,0.1746,0.0174,0.0046,0.0052,0.0139,0.0222,0.0854,0.0004,0.0047,0.0084,0.0078,0.0402,0.0356,0.0077,0.0024,0.0442,0.2909,0.0990,0.0015,0.0031,0.0030,0.0008,0.0004,0.1950,0.2909,0.0541,0.0007,0.0003,0.0005,0.0011,0.0116,0.0437,0.0776,0.0251,0.0202,0.0086,0.0076,0.0033,0.0044,0.0002,0.0035,0.0120,0.0336,0.0341,0.0135,0.0021,0.0001,
				  0.0437,0.0006,0.0021,0.0054,0.0018,0.0043,0.0580,0.3034,0.1735,0.0091,0.0002,0.0002,     0,0.0004,0.0194,0.3034,0.0533,0.0293,0.0177,0.0009,0.0006,0.0081,0.0182,0.0480,0.0018,0.0097,0.0371,0.0100,0.0068,0.0168,0.0345,0.0039,0.0593,0.0505,0.0367,0.0089,0.0059,0.0049,0.0065,0.0579,0.3034,0.2407,0.0413,0.0008,0.0002,0.0001,0.0019,0.3034,0.1669,0.0738,0.0118,0.0085,0.0119,0.0079,0.0149,0.1374,0.0015,0.0013,0.0041,0.0118,0.0333,0.0313,0.0448,0.0069,0.0261,0.2454,0.3034,0.0182,0.0028,0.0015,0.0024,0.0031,0.2328,0.3034,0.3034,0.0124,0.0017,0.0009,0.0004,0.0147,0.0740,0.0818,0.0334,0.0360,0.0195,0.0077,0.0107,0.0183,0.0024,0.0034,0.0042,0.0142,0.0438,0.0219,0.0080,0.0067,0.0099,0.0259,0.1813,0.0218,0.0069,0.0097,0.0191,0.0236,0.0161,0.0390,0.0724,0.0185,0.0073,0.0063,0.0052,0.0120,0.0070,0.0065,0.0093,0.0381,0.0199,0.0069,0.0022,0.0056,0.0019,0.0030,0.0057,0.0374,0.0388,0.0106,0.0048,0.0072

	};
	float C[4];
	

	int sz;
	printf("before call cuda\n");
	fflush( stdout );
	sz = cuda_match_two_set(A, 2, B, 3, 128, C, 1.5);

	
	printf("sz=%d\n", sz);
	for (int i = 0; i < sz * 2; i++)
		printf("%f ", C[i] - 1);
	printf("\n");

}
